<ng-container *ngIf="product() as productData">
    <form [formGroup]="form" class="product-details-content container">
      <div class="product-grid">
        <!-- Imagen -->
        <div class="product-image">
          <img
            *ngIf="productData.images?.length"
            [src]="productData.images[0]"
            [alt]="productData.title"
            style="width: 300px; object-fit: contain; border-radius: 4px;"
          />
        </div>
  
        <!-- Info -->
        <div class="product-info">
          <div style="padding: 16px; display: flex; flex-direction: column; gap: 8px;">
  
            <!-- Título -->
            <ng-container *ngIf="!isEditing(); else editTitle">
              <h2>{{ productData.title }}</h2>
            </ng-container>
            <ng-template #editTitle>
              <mat-form-field appearance="fill">
                <mat-label>Título</mat-label>
                <input matInput formControlName="title" />
                <mat-error *ngIf="form.controls.title.invalid">Campo requerido</mat-error>
              </mat-form-field>
            </ng-template>
  
            <!-- Precio -->
            <p *ngIf="!isEditing()">
              <strong>Precio:</strong>
              {{ productData.price | currencyFormat }}
            </p>
            <mat-form-field appearance="fill" *ngIf="isEditing()">
              <mat-label>Precio</mat-label>
              <input type="number" matInput formControlName="price" />
              <mat-error *ngIf="form.controls.price.invalid">Campo requerido</mat-error>
            </mat-form-field>
  
            <!-- Stock -->
            <p *ngIf="!isEditing()">
              <strong>Stock:</strong>
              <span [style.color]="productData.stock | stockColor">
                {{ productData.stock }}
              </span>
            </p>
            <mat-form-field appearance="fill" *ngIf="isEditing()">
              <mat-label>Stock</mat-label>
              <input type="number" matInput formControlName="stock" />
              <mat-error *ngIf="form.controls.stock.invalid">Campo requerido</mat-error>
            </mat-form-field>
  
            <!-- Descripción -->
            <p *ngIf="!isEditing()">
              <strong>Descripción:</strong> {{ productData.description }}
            </p>
            <mat-form-field appearance="fill" *ngIf="isEditing()">
              <mat-label>Descripción</mat-label>
              <textarea matInput formControlName="description" rows="3"></textarea>
              <mat-error *ngIf="form.controls.description.invalid">Campo requerido</mat-error>
            </mat-form-field>
  
            <!-- Info adicional no editable -->
            <p><strong>Marca:</strong> {{ productData.brand }}</p>
            <p><strong>Rating:</strong> {{ productData.rating }} ⭐</p>
            <p><strong>Descuento:</strong> {{ productData.discountPercentage }}%</p>
  
          </div>
  
          <!-- Botones -->
          <div class="buttons-wrapper">
            <button mat-stroked-button type="button" (click)="onCancelEdit()" *ngIf="isEditing()">Cancelar</button>
            <button mat-flat-button type="submit" color="primary" (click)="onSave()" *ngIf="isEditing()">Guardar</button>
            <button mat-flat-button type="button" color="accent" (click)="onEnableEdit()" *ngIf="!isEditing()">Editar</button>
          </div>
        </div>
      </div>
    </form>
  </ng-container>
  